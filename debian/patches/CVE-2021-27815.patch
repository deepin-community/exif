Description: Prevent NULL pointer dereference when printing formatted XML
Author: Hugh McMaster <hugh.mcmaster@outlook.com>
Bug: https://github.com/libexif/exif/issues/4
Bug-Debian: https://bugs.debian.org/1018814
Forwarded: https://github.com/libexif/exif/pull/12
Last-Update: 2022-09-05

--- a/exif/actions.c
+++ b/exif/actions.c
@@ -661,6 +661,8 @@
 	char *out;
 	size_t len;
 
+        if (!text || !*text) return "";
+
 	for (out=escaped, len=0; *text; ++len, ++out, ++text) {
 		/* Make sure there's plenty of room for a quoted character */
 		if ((len + 8) > escaped_size) {
